### A robust and efficient not-only-linear dependence coefficient

![
**Different types of relationships in data.**
Each panel contains a set of simulated data points described by two generic variables: $x$ and $y$.
The first row shows Anscombe's quartet with four different datasets (from Anscombe I to IV) and 11 data points each.
The second row contains a set of general patterns with 100 data points each.
Each panel shows the correlation value using Pearson ($p$), Spearman ($s$) and CCC ($c$).
Vertical and horizontal red lines show how CCC clustered data points using $x$ and $y$.
](images/intro/relationships.svg "Different types of relationships in data"){#fig:datasets_rel width="100%"}

The Correlation Coefficient Cluster (CCC) is designed to measure the similarity between any two variables, regardless of whether they are numerical or categorical.
This approach is grounded in the idea that if two variables describe a set of data points and there is a relationship between them, then the way these points cluster according to each variable should be similar.
For numerical data, the CCC method employs quantiles to effectively group data points into clusters, with a simple example being how the median divides data into two groups.
After clustering data points based on each variable, the CCC is determined by calculating the maximum adjusted Rand index (ARI), which is a value between 0 and 1 that measures the similarity between the clusters.
The ARI's calculation and its significance are elaborated in the Methods section under the CCC algorithm description.


We evaluated the behavior of Pearson ($p$), Spearman ($s$), and CCC ($c$) correlation coefficients across various simulated data patterns.
Specifically, the first row of Figure @fig:datasets_rel showcases the classic Anscombe's quartet, which consists of four synthetic datasets.
Despite having identical statistical properties (mean, standard deviation, and Pearson's correlation), these datasets display different patterns.
This type of simulated data, also highlighted by the more recent "Datasaurus" dataset, emphasizes the need to look beyond basic statistics.
Simple summary statistics can either hide unwanted patterns, like outliers, or obscure meaningful nonlinear relationships, which could be significant in contexts such as gene expression analysis.


The study presents an analysis of the newly proposed Correlation Coefficient based on Clustering (CCC) in comparison to traditional Pearson and Spearman correlation coefficients, using Anscombe's quartet as test datasets.
Anscombe I, with its noisy yet clear linear trend, and Anscombe III, characterized by perfect linearity except for a single outlier, both received a CCC score of 1.0.
This score indicates a strong linear relationship, as CCC successfully identified two clusters corresponding to the variables $x$ and $y$ in each dataset.

In contrast, Anscombe II, which displays a quadratic relationship misinterpreted as linear by Pearson and Spearman, received a CCC score of 0.34.
This score reflects the CCC's ability to recognize the complexity of the relationship beyond mere linearity.
Anscombe IV, featuring a vertical line of data points with almost constant $x$ values except for one outlier, was scored at 0.00 by CCC.
This score accurately signals no association between the variable pair, unaffected by the outlier that skews Pearson and Spearman's results.
The discrepancy arises because the data does not adhere to CCC's clustering assumption, where the clusters identified in $x$ and $y$ do not align.

Across all Anscombe datasets, Pearson's correlation coefficient remains constant at 0.82, and Spearman's coefficient is always 0.50 or higher.
These results highlight the proficiency of Pearson and Spearman in identifying linear correlations.
However, their effectiveness diminishes when faced with nonlinear relationships or outliers, underscoring the CCC's advantage in handling such complexities.


In our study, we explored various types of relationships, as depicted in the second row of Figure @fig:datasets_rel, some of which have been previously identified in gene expression data [@doi:10.1126/science.1205438; @doi:10.3389/fgene.2019.01410; @doi:10.1091/mbc.9.12.3273].
When examining pairs of variables that were random or independent, all correlation coefficients consistently indicated a near-zero relationship, as expected.
Interestingly, in the non-coexistence pattern, where one gene ($x$) is active while the other ($y$) is suppressed—a scenario suggesting a significant biological interaction, such as microRNA inhibiting a gene—all coefficients successfully identified this relationship.

However, for more complex relationships, such as quadratic and two-lines patterns, traditional Pearson and Spearman coefficients failed to recognize the non-linear dynamics between variables $x$ and $y$.
This limitation underscores the effectiveness of our Correlation Coefficient based on Machine Learning (CCC), which adeptly captures these intricate patterns by adjusting its complexity.
For instance, in the quadratic pattern, CCC delineated four distinct clusters for $x$ to maximize the Adjusted Rand Index (ARI), demonstrating its nuanced approach to relationship detection.
Similarly, in the two-lines pattern, which consists of two distinct linear relationships with varying slopes, neither Pearson nor Spearman coefficients detected the underlying pattern ($p=-0.12$ and $s=0.05$, respectively).
Conversely, CCC adapted by employing eight clusters for $x$ and six for $y$, achieving a correlation of $c=0.31$, thereby illustrating its superior capability to model and identify complex non-linear relationships.
